<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Subjects</title>
  <script src="https://kit.fontawesome.com/a2e0e6ad65.js" crossorigin="anonymous"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">

  <!-- Container -->
  <div class="max-w-6xl mx-auto mt-32 px-4">
    <h1 class="text-4xl text-center font-bold text-gray-900 mb-10">Subjects Offered</h1>

    <!-- Search -->
    <div class="mb-8 flex justify-center">
      <input 
        id="searchInput" 
        type="text" 
        class="w-full max-w-2xl px-5 py-3 rounded-full border border-gray-300 shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-purple-600 transition"
        placeholder="Search by subject..."
      />
    </div>

    <!-- Tooltip -->
    <div id="searchTooltip" class="hidden text-center mb-6">
      <span class="bg-yellow-400 text-gray-900 px-4 py-2 rounded-lg shadow animate-bounce">
        â¬† Enter a subject name to search
      </span>
    </div>

    <!-- Subject Categories -->
    <div id="subject-list" class="space-y-6"></div>
  </div>

  <!-- Footer -->
  <footer class="mt-20 py-8 bg-purple-900 text-white text-center relative overflow-hidden">
    <div class="flex justify-center items-center space-x-3 animate__animated animate__fadeInUp">
      <img src="logo.png" alt="Logo" class="h-10 w-10 animate__animated animate__rollIn animate__delay-1s">
      <span class="font-extrabold text-lg animate__animated animate__fadeInRight animate__delay-2s">EduQuiz</span>
    </div>
    <p class="mt-3 text-sm">&copy; <span id="year"></span> EduQuiz. All rights reserved.</p>
  </footer>

  <script>
    // Auto-update year
    document.getElementById("year").textContent = new Date().getFullYear();

    // Typing placeholder animation
    const placeholderText = "search by subject here...";
    let i = 0;
    function typePlaceholder() {
      if (i <= placeholderText.length) {
        document.getElementById("searchInput")
          .setAttribute("placeholder", placeholderText.slice(0, i));
        i++;
        setTimeout(typePlaceholder, 120);
      }
    }
    typePlaceholder();

    const subjectList = document.getElementById("subject-list");
    const searchInput = document.getElementById("searchInput");
    const tooltip = document.getElementById("searchTooltip");
    let subjects = {};

    // Load subjects.json
    async function loadSubjects() {
      try {
        const res = await fetch("subjects.json");
        subjects = await res.json();
        renderSubjects();
      } catch (err) {
        console.error("Failed to load subjects.json", err);
        subjectList.innerHTML =
          "<p class='text-red-600 text-center'>Failed to load subjects.</p>";
      }
    }

    function renderSubjects(filter = "") {
      subjectList.innerHTML = "";

      Object.keys(subjects).forEach((category) => {
        // Group container
        const groupDiv = document.createElement("div");
        groupDiv.className = "bg-white rounded-xl shadow p-6";

        // Category heading
        const heading = document.createElement("h2");
        heading.className =
          "flex justify-between items-center cursor-pointer text-xl font-semibold text-gray-900 border-b border-gray-200 pb-3";
        heading.innerHTML = `${category} <i class="fas fa-chevron-down transition-transform duration-300"></i>`;

        // Subject list container
        const listDiv = document.createElement("div");
        listDiv.className =
          "subject-list max-h-0 overflow-hidden transition-all duration-500 space-y-2 pb-4";

        // Add filtered subjects
        subjects[category]
          .filter((sub) =>
            sub.toLowerCase().includes(filter.toLowerCase())
          )
          .forEach((sub) => {
            const item = document.createElement("a");
            item.className =
              "block px-4 py-3 rounded-lg bg-gray-100 hover:bg-yellow-400 hover:text-gray-900 transition transform scale-100";
            item.href = `quiz.html?subject=${encodeURIComponent(sub)}`;
            item.textContent = sub;
            listDiv.appendChild(item);
          });

        // Toggle list
        heading.addEventListener("click", () => {
          listDiv.classList.toggle("max-h-0");
          listDiv.classList.toggle("max-h-96");
          heading.querySelector("i").classList.toggle("rotate-180");
        });

        groupDiv.appendChild(heading);
        groupDiv.appendChild(listDiv);
        subjectList.appendChild(groupDiv);
      });
    }

    // Search filtering
    searchInput.addEventListener("input", (e) => {
      const value = e.target.value.trim();
      renderSubjects(value);
      // expand all when typing
      document
        .querySelectorAll("#subject-list .max-h-0")
        .forEach((list) => list.classList.replace("max-h-0", "max-h-96"));
    });

    // Tooltip for empty search on Enter
    searchInput.addEventListener("keydown", (e) => {
      if (e.key === "Enter" && e.target.value.trim() === "") {
        tooltip.classList.remove("hidden");
        setTimeout(() => {
          tooltip.classList.add("hidden");
        }, 10000);
      }
    });

    loadSubjects();
  </script>
</body>
</html>

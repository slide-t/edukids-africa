<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EduKids Africa | Topic Details</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 text-gray-800">

  <!-- Header -->
  <header class="bg-purple-700 text-white p-4 shadow-md">
    <h1 class="text-xl font-bold">EduKids Africa – Topic Details</h1>
  </header>

  <!-- Main Container -->
  <main class="max-w-3xl mx-auto p-6">
    <!-- Back button -->
    <button onclick="history.back()" 
      class="mb-4 px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded shadow">
      ← Back
    </button>

    <!-- Topic content -->
    <section id="topicContent" class="bg-white p-6 rounded-lg shadow-lg">
      <h2 id="topicTitle" class="text-2xl font-bold text-purple-700 mb-4"></h2>
      <div id="topicBody" class="prose max-w-none mb-6"></div>

      <!-- Example Section -->
      <div id="examplesSection" class="mb-6 hidden">
        <h3 class="text-xl font-semibold text-gray-800 mb-2">Examples:</h3>
        <ul id="examplesList" class="list-disc list-inside space-y-2"></ul>
      </div>

      <!-- Image Section -->
      <div id="imageSection" class="hidden">
        <h3 class="text-xl font-semibold text-gray-800 mb-2">Illustration:</h3>
        <img id="topicImage" src="" alt="Topic illustration" class="rounded shadow-md max-h-64">
      </div>
    </section>
  </main>

  <script>
    async function loadTopicDetails() {
      const params = new URLSearchParams(window.location.search);
      const year = params.get("year");     // e.g. year1
      const subject = params.get("subject"); // e.g. Mathematics
      const topicId = params.get("topic");   // e.g. numbers

      if (!year || !subject || !topicId) {
        document.getElementById("topicContent").innerHTML = 
          "<p class='text-red-600'>Invalid topic details provided in URL.</p>";
        return;
      }

      try {
        // Fetch the correct JSON file
        const filePath = `Lessons/${year}/${subject}/topics-details.json`;
        const res = await fetch(filePath);
        const topics = await res.json();

        // Find topic
        const topic = topics.find(t => t.id === topicId);
        if (!topic) {
          document.getElementById("topicContent").innerHTML = 
            "<p class='text-red-600'>Topic not found.</p>";
          return;
        }

        // Fill data
        document.getElementById("topicTitle").textContent = topic.title;
        document.getElementById("topicBody").innerHTML = topic.content;

        if (topic.examples && topic.examples.length > 0) {
          document.getElementById("examplesSection").classList.remove("hidden");
          const ul = document.getElementById("examplesList");
          topic.examples.forEach(ex => {
            const li = document.createElement("li");
            li.textContent = ex;
            ul.appendChild(li);
          });
        }

        if (topic.image) {
          document.getElementById("imageSection").classList.remove("hidden");
          document.getElementById("topicImage").src = topic.image;
        }
      } catch (err) {
        console.error("Error loading topic details:", err);
        document.getElementById("topicContent").innerHTML = 
          "<p class='text-red-600'>Unable to load topic details.</p>";
      }
    }

    loadTopicDetails();
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EduKids Africa - Books</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Mobile menu slide animation */
    #mobile-menu {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.4s ease-in-out;
    }
    #mobile-menu.open {
      max-height: 500px;
    }

    /* Hamburger → X animation */
    .line {
      transition: all 0.3s ease-in-out;
      transform-origin: center;
    }
    .active .line1 {
      transform: rotate(45deg) translate(5px, 5px);
    }
    .active .line2 {
      opacity: 0;
    }
    .active .line3 {
      transform: rotate(-45deg) translate(5px, -5px);
    }
  </style>
</head>
<body class="bg-white text-gray-900 min-h-screen">

  <!-- HEADER -->
  <header class="bg-white shadow-md sticky top-0 z-50">
    <div class="max-w-7xl mx-auto flex items-center justify-between p-4 md:p-6">
      <!-- Logo -->
      <div class="flex items-center space-x-3">
        <img src="https://slide-t.github.io/edukids-africa/images/logo.png" alt="EduKids Africa Logo" class="w-12 h-12 md:w-14 md:h-14 rounded-full">
        <h1 class="text-2xl md:text-3xl font-bold text-orange-600">EduKids Africa</h1>
      </div>

      <!-- Mobile Menu Button -->
      <div class="md:hidden">
        <button id="menu-btn" class="focus:outline-none flex flex-col justify-between w-9 h-9">
          <span class="line line1 w-full h-1 bg-gray-800 rounded"></span>
          <span class="line line2 w-full h-1 bg-gray-800 rounded"></span>
          <span class="line line3 w-full h-1 bg-gray-800 rounded"></span>
        </button>
      </div>

      <!-- Desktop Nav -->
      <nav class="hidden md:flex md:space-x-6 text-lg font-medium">
        <a href="https://slide-t.github.io/edukids-africa/index.html#home" class="px-4 py-2 rounded hover:bg-orange-500 hover:text-white transition">Home</a>
        <a href="subjects.html" class="px-4 py-2 rounded hover:bg-orange-500 hover:text-white transition">Subjects</a>
        <a href="#" class="px-4 py-2 rounded hover:bg-orange-500 hover:text-white transition">About</a>
        <a href="#" class="px-4 py-2 rounded hover:bg-orange-500 hover:text-white transition">Contact</a>
      </nav>
    </div>

    <!-- Mobile Nav -->
    <nav id="mobile-menu" class="flex-col space-y-2 px-6 pb-4 bg-white shadow-md md:hidden hidden">
      <a href="https://slide-t.github.io/edukids-africa/index.html#home" class="block px-4 py-2 rounded hover:bg-orange-500 hover:text-white transition">Home</a>
      <a href="subjects.html" class="block px-4 py-2 rounded hover:bg-orange-500 hover:text-white transition">Subjects</a>
      <a href="#" class="block px-4 py-2 rounded hover:bg-orange-500 hover:text-white transition">About</a>
      <a href="#" class="block px-4 py-2 rounded hover:bg-orange-500 hover:text-white transition">Contact</a>
    </nav>
  </header>

  <!-- Search & Filters -->
  <section class="p-6">
    <div class="flex flex-col md:flex-row gap-4">
      <input 
        id="searchBar" 
        type="text" 
        placeholder="Search by title..." 
        class="p-2 rounded-md border border-gray-400 text-black w-full md:w-1/3"
      />
      <select id="filterAuthor" class="p-2 rounded-md border border-gray-400 text-black w-full md:w-1/3">
        <option value="">Filter by Author</option>
      </select>
      <select id="filterSubject" class="p-2 rounded-md border border-gray-400 text-black w-full md:w-1/3">
        <option value="">Filter by Subject</option>
      </select>
    </div>
  </section>

  <!-- Books Grid -->
  <main class="p-6">
    <div id="books-container" class="grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-6"></div>
  </main>

  <!-- Modal for Description -->
  <div id="bookModal" class="fixed inset-0 hidden bg-black bg-opacity-70 flex items-center justify-center z-50">
    <div class="bg-white text-gray-900 p-6 rounded-lg shadow-lg max-w-lg w-full relative">
      <button onclick="closeModal()" class="absolute top-2 right-2 text-gray-600 text-xl">✖</button>
      <h2 id="modalTitle" class="text-2xl font-bold mb-2"></h2>
      <p id="modalAuthor" class="mb-2 text-purple-700"></p>
      <p id="modalDescription" class="text-gray-700"></p>
    </div>
  </div>

  <script>
    let booksData = [];

    // Load JSON
    async function loadBooks() {
      const response = await fetch("books.json");
      booksData = await response.json();
      displayBooks(booksData);
      populateFilters();
    }

    // Display Books
    function displayBooks(books) {
      const container = document.getElementById("books-container");
      container.innerHTML = "";
      books.forEach(book => {
        const card = document.createElement("div");
        card.className = "bg-gray-100 rounded-lg shadow-lg overflow-hidden hover:scale-105 transition-transform";

        card.innerHTML = `
          <img src="${book.image}" alt="${book.title}" class="w-full h-40 object-cover">
          <div class="p-4">
            <h3 class="text-lg font-bold text-gray-900">${book.title}</h3>
            <p class="text-sm text-gray-600">by ${book.author}</p>
            <button onclick="openModal('${book.title}','${book.author}','${book.description}')" 
              class="mt-2 text-sm text-purple-700 underline">Read More</button>
            <div class="mt-4">
              <button onclick="toggleCart(this)" class="bg-gray-300 text-black px-3 py-1 rounded-md w-full">
                Add to Cart
              </button>
              <a href="your-pwa-link" 
                class="hidden mt-2 block bg-purple-800 text-white px-3 py-1 rounded-md text-center">
                Buy Now
              </a>
            </div>
          </div>
        `;
        container.appendChild(card);
      });
    }

    // Toggle Add to Cart → Buy Now
    function toggleCart(button) {
      const buyNowBtn = button.nextElementSibling;
      buyNowBtn.classList.toggle("hidden");
    }

    // Open Modal
    function openModal(title, author, description) {
      document.getElementById("modalTitle").textContent = title;
      document.getElementById("modalAuthor").textContent = "by " + author;
      document.getElementById("modalDescription").textContent = description;
      document.getElementById("bookModal").classList.remove("hidden");
    }

    // Close Modal
    function closeModal() {
      document.getElementById("bookModal").classList.add("hidden");
    }

    // Filters
    function populateFilters() {
      const authors = [...new Set(booksData.map(book => book.author))];
      const subjects = [...new Set(booksData.map(book => book.subject))];

      const authorFilter = document.getElementById("filterAuthor");
      const subjectFilter = document.getElementById("filterSubject");

      authors.forEach(author => {
        const option = document.createElement("option");
        option.value = author;
        option.textContent = author;
        authorFilter.appendChild(option);
      });

      subjects.forEach(subject => {
        const option = document.createElement("option");
        option.value = subject;
        option.textContent = subject;
        subjectFilter.appendChild(option);
      });
    }

    // Search + Filter Functionality
    document.getElementById("searchBar").addEventListener("input", filterBooks);
    document.getElementById("filterAuthor").addEventListener("change", filterBooks);
    document.getElementById("filterSubject").addEventListener("change", filterBooks);

    function filterBooks() {
      const search = document.getElementById("searchBar").value.toLowerCase();
      const author = document.getElementById("filterAuthor").value;
      const subject = document.getElementById("filterSubject").value;

      const filtered = booksData.filter(book => {
        return (
          book.title.toLowerCase().includes(search) &&
          (author === "" || book.author === author) &&
          (subject === "" || book.subject === subject)
        );
      });

      displayBooks(filtered);
    }

    loadBooks();

    // Mobile menu toggle
    const menuBtn = document.getElementById('menu-btn');
    const mobileMenu = document.getElementById('mobile-menu');

    mobileMenu.classList.remove('flex');
    mobileMenu.classList.add('hidden');

    menuBtn.addEventListener('click', () => {
      menuBtn.classList.toggle('active');

      if (mobileMenu.classList.contains('hidden')) {
        mobileMenu.classList.remove('hidden');
        setTimeout(() => mobileMenu.classList.add('open'), 10);
      } else {
        mobileMenu.classList.remove('open');
        setTimeout(() => mobileMenu.classList.add('hidden'), 400);
      }
    });
  </script>
</body>
</html>
